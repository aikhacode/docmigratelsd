"use strict";(self.webpackChunkdocmigrate=self.webpackChunkdocmigrate||[]).push([[645],{4932:function(a,e,n){n.r(e),n.d(e,{frontMatter:function(){return s},contentTitle:function(){return m},metadata:function(){return l},toc:function(){return p},default:function(){return u}});var t=n(7462),r=n(3366),i=(n(7294),n(3905)),o=["components"],s={sidebar_position:1},m="Migration dan Impor/Ekspor",l={unversionedId:"tutorial-extras/migration",id:"tutorial-extras/migration",isDocsHomePage:!1,title:"Migration dan Impor/Ekspor",description:"Secara garis besar proses migration dan impor/ekspor csv/json dapat dilakukan dengan proses sbb:",source:"@site/docs/tutorial-extras/migration.md",sourceDirName:"tutorial-extras",slug:"/tutorial-extras/migration",permalink:"/docmigratelsd/tutorial-extras/migration",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Select, Insert, Update, Delete Data from table",permalink:"/docmigratelsd/tutorial-basics/select-data"},next:{title:"Background Process",permalink:"/docmigratelsd/tutorial-extras/background-proc"}},p=[{value:"Contoh Migrasi",id:"contoh-migrasi",children:[],level:2},{value:"Impor &amp; Ekspor CSV",id:"impor--ekspor-csv",children:[],level:2},{value:"Impor &amp; Ekspor JSON",id:"impor--ekspor-json",children:[],level:2}],d={toc:p};function u(a){var e=a.components,n=(0,r.Z)(a,o);return(0,i.kt)("wrapper",(0,t.Z)({},d,n,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"migration-dan-imporekspor"},"Migration dan Impor/Ekspor"),(0,i.kt)("p",null,"Secara garis besar proses migration dan impor/ekspor csv/json dapat dilakukan dengan proses sbb:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"call instance turunan class migration"),(0,i.kt)("li",{parentName:"ul"},"definisikan method untuk proses migrasinya karena tiap proses mungkin bisa berubah gaya migrasinya maka didefinisikan tiap class turunannya masing masing"),(0,i.kt)("li",{parentName:"ul"},"definisikan method impor/ekspor sesuai format yang diperlukan")),(0,i.kt)("h2",{id:"contoh-migrasi"},"Contoh Migrasi"),(0,i.kt)("p",null,"Berikut contoh metode migrasi dari report di pecah ke pasangan meta key dan meta value "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"...\npublic function migrate_to_meta(Migration $table_meta)\n    {\n        $fields = $this->get_column_titles();\n\n        $id = $fields[0];\n        $tblname1 = $this->get_table_name();\n        $tblname2 = $table_meta->get_table_name();\n\n        $limit = 10000;\n        $offset = 0;\n        $rownum = $this->query()->execute(\"select count($id) as jml from $tblname1\");\n\n\n        $jmlrow = $rownum[0]['jml'];\n        \n        $max_execution_time = ini_get('max_execution_time');\n        ini_set('max_execution_time', 0);\n\n        while ($offset < $jmlrow) {\n            $rows = $this->query()->execute(\"select * from $tblname1 limit $limit offset $offset\");\n            $data = array();\n            $i = 0;\n            foreach ($rows as $row) {\n                $data[$i] = array(\n                    'report_id' => $row['report_id'],\n                    'meta_key' => 'user_id',\n                    'meta_value' => $row['user_id']\n                );\n                $i++;\n                $data[$i] = array(\n                    'report_id' => $row['report_id'],\n                    'meta_key' => 'program_id',\n                    'meta_value' => $row['program_id']\n                );\n                $i++;\n                $data[$i] = array(\n                    'report_id' => $row['report_id'],\n                    'meta_key' => 'name',\n                    'meta_value' => $row['name']\n                );\n                $i++;\n                $data[$i] = array(\n                    'report_id' => $row['report_id'],\n                    'meta_key' => 'messages',\n                    'meta_value' => $row['messages']\n                );\n                $i++;\n                $data[$i] = array(\n                    'report_id' => $row['report_id'],\n                    'meta_key' => 'date',\n                    'meta_value' => $row['date']\n                );\n            }\n\n            $table_meta->insert($data);\n\n\n            $lendata = count($data);\n\n            $offset = $offset + $limit;\n        }\n\n        \n\n        ini_set('max_execution_time', $max_execution_time);\n         return array(\n            \"fields\" => $fields,\n            \"jml_row\" => $rownum,\n            \n            \n\n        );\n    }\n}\n...\n")),(0,i.kt)("h2",{id:"impor--ekspor-csv"},"Impor & Ekspor CSV"),(0,i.kt)("p",null,"Impor csv dapat dilakukan dengan mendefinisikan instance class Impor_From_CSV dengan paramater data content dari CSV"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"...\n    $data = new Import_From_CSV(file_get_contents(__DIR__ . '/test/file.csv'));\n    $reports->import($data);\n...\n")),(0,i.kt)("p",null,"Ekspor csv dapat dilakukan dengan mendefinisikan instance class Export_To_CSV dengan paramater data content table"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"...   \n    $data = new Export_To_CSV($reports->query()->get_results());\n    $reports->export($data);\n...\n")),(0,i.kt)("h2",{id:"impor--ekspor-json"},"Impor & Ekspor JSON"),(0,i.kt)("p",null,"Impor json dapat dilakukan dengan mendefinisikan instance class Impor_From_JSON dengan paramater data content dari json"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"...\n    $data = new Import_From_JSON(file_get_contents(__DIR__ . '/test/file.json'));\n    $reports->import($data);\n...\n")),(0,i.kt)("p",null,"Ekspor json dapat dilakukan dengan mendefinisikan instance class Export_To_JSON dengan paramater data content table"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"...   \n    $data = new Export_To_JSON($reports->query()->get_results());\n    $reports->export($data);\n...\n")))}u.isMDXComponent=!0}}]);